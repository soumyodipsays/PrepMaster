CREATE OR ALTER PROC sp_SignUp
    @FullName VARCHAR(100),
    @Email VARCHAR(150),
    @PasswordHash VARCHAR(255),
    @Role VARCHAR(20)
AS
BEGIN
    SET NOCOUNT ON;

    IF EXISTS (SELECT 1 FROM Users WHERE Email = @Email)
    BEGIN
        -- Custom Error
        THROW 50001, 'Email already exists.', 1;
    END
    ELSE
    BEGIN
        INSERT INTO Users (FullName, Email, PasswordHash, Role)
        VALUES (@FullName, @Email, @PasswordHash, @Role);

        SELECT SCOPE_IDENTITY() AS UserId;
    END
END
GO


